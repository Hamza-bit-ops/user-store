"use strict";(()=>{var e={};e.id=701,e.ids=[701],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6086:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>c});var n=t(9303),a=t(8716),o=t(670),i=t(7070),u=t(8263),l=t(1732);async function p(e){try{await (0,u.Z)();let e=await l.Z.find({});return i.NextResponse.json({users:e},{status:200})}catch(e){return i.NextResponse.json({error:"Failed to fetch users"},{status:500})}}async function c(e){try{let r=await e.json();await (0,u.Z)();let t=new l.Z(r);return await t.save(),i.NextResponse.json({user:t},{status:201})}catch(e){if(11e3===e.code)return i.NextResponse.json({error:"Email already exists"},{status:400});return i.NextResponse.json({error:"Failed to create user"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:"app/api/users/route"},resolvedPagePath:"D:\\Next Js\\user\\app\\api\\users\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:h}=d,x="/api/users/route";function f(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}},8263:(e,r,t)=>{t.d(r,{Z:()=>i});var s=t(1185),n=t.n(s);let a=process.env.MONGODB_URI;if(!a)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose??{conn:null,promise:null};global.mongoose=o;let i=async function(){if(o.conn)return o.conn;o.promise||(o.promise=n().connect(a,{bufferCommands:!1}));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},1732:(e,r,t)=>{t.d(r,{Z:()=>a});var s=t(1185);let n=new s.Schema({name:{type:String,required:[!0,"Please provide a name"],maxlength:[60,"Name cannot be more than 60 characters"]},number:{type:String,required:[!0,"Please provide a number"],unique:!0},address:{type:String,required:[!0,"Please provide an address"]}},{timestamps:!0});n.virtual("accounts",{ref:"Account",localField:"_id",foreignField:"userId"}),n.set("toJSON",{virtuals:!0}),n.set("toObject",{virtuals:!0});let a=s.models.User||(0,s.model)("User",n)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972],()=>t(6086));module.exports=s})();